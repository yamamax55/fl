# Galaxy RTS - 銀河英雄伝説RTS

## 概要
銀河英雄伝説の世界観を基にしたリアルタイム戦略ゲームです。

## セットアップ
```bash
npm install
npm run dev
```

## 操作方法
### 基本操作
- **艦隊選択**: 同盟軍（青い三角形）を左クリック
- **ドラッグ選択**: 空白地をドラッグして複数艦隊選択
- **選択解除**: 空白地をクリック
- **自動戦闘**: 前方楕円形範囲内の敵を自動攻撃（ビーム攻撃と爆発エフェクト）
- **応戦時滑らか回転**: 戦闘時の敵への向き変更も滑らかなアニメーション
- **勝利条件**: 敵陣営を全滅させると勝利

### デュアルモード操作システム（Phase 5新機能）
- **1回クリック**: 移動モード（緑色の選択枠）
  - 右クリック先に艦隊が移動
  - **進行方向に回転してから移動開始**（回転完了後に移動実行、現実的な艦隊機動）
  - **移動予定地点に半透明ゴースト艦隊を表示**（他艦隊選択時も移動完了まで継続表示、目標位置での向きも表示）
  - **移動先確定時に選択状態を自動解除**
- **ダブルクリック**: 回転モード（赤色の選択枠）
  - 右クリック方向に艦隊が**滑らかに回転**
  - **赤色の前方楕円形射程を表示**（現実的な戦術的判断支援）
  - **紫色のZOC（支配領域）範囲を表示**（敵検出・自動対応範囲）
  - 戦術的位置取りのための精密な方向制御
  - **回転方向確定時に選択状態を自動解除**
- **モード表示**: UI上部に現在のモードを表示 `[移動]` `[回転]` `[待機]`

### 戦術的操作の特徴
- **方向の重要性**: 艦隊の向きが前方楕円形攻撃範囲と戦闘効率に直結
- **滑らかなアニメーション**: ゆっくりとした回転で正確な角度設定
- **戦闘時滑らか回転**: 敵への応戦時も滑らかな自動向き変更で現実的な戦闘
- **現実的な移動機動**: 移動時は進行方向に回転完了後に移動実行
- **前方楕円形攻撃**: 現実的な艦隊戦闘を再現した方向性攻撃システム
- **射程表示**: 回転モード時に赤色の前方楕円で戦術的判断を支援
- **ZOC（支配領域）システム**: 敵が範囲内に侵入すると自動的に追尾回転（手動操作優先）
- **移動プレビュー**: 移動予定地点でゴースト艦隊を継続表示（他艦隊選択時も移動完了まで継続表示）
- **制御の優先**: 回転中は他の自動向き変更を一時無効化
- **自動選択解除**: 移動・回転確定後は他の艦隊操作を即座に可能に

### UI機能
- **情報パネル**: 画面上部に選択艦隊数と各陣営の残存数を表示
- **艦隊詳細**: 選択艦隊のHP情報と現在モードを表示
- **ゲーム制御**: 一時停止、速度変更（0.5x/1x/2x）、音声ミュート（Phase 4）

## 開発状況
**Phase 1: 基本表示実装完了**
- ✅ 黒い宇宙背景（1280x720）
- ✅ 同盟軍艦隊（青い四角）表示
- ✅ 帝国軍艦隊（赤い四角）表示

**Phase 2: インタラクション実装完了**
- ✅ Fleet クラス実装
- ✅ 左クリックで艦隊選択（黄色選択枠）
- ✅ 右クリックで移動指示
- ✅ 滑らかな移動アニメーション
- ✅ ゲームループ（毎フレーム更新）

**Phase 3: 多艦隊管理と戦闘システム実装完了**
- ✅ 複数艦隊配置（各陣営3隻ずつ）
- ✅ ドラッグ範囲選択機能
- ✅ 艦隊HP管理システム（最大HP: 10000）
- ✅ 自動戦闘システム（攻撃力: 1000、射程: 150px、攻撃間隔: 1秒）
- ✅ HPバー表示（色による状態表示）
- ✅ UI表示（画面上部に選択艦隊数とHP情報）
- ✅ ファイル構成分離（Fleet.js、Game.js、GameUI.js）

**Phase 4: UIシステムと演出強化実装完了**
- ✅ 包括的UIシステム（上部統計、下部詳細、右下ミニマップ）
- ✅ ゲーム制御機能（一時停止、速度変更、音声ミュート）
- ✅ 勝利条件システムとゲーム終了画面
- ✅ 戦闘統計（撃破数、損失数、ゲーム時間表示）
- ✅ 艦隊の三角形表示と移動方向の視覚化
- ✅ ビジュアルエフェクト（ビーム攻撃、爆発パーティクル、ダメージ数値）
- ✅ プロシージャル音響システム（BGM、レーザー音、爆発音、選択音）
- ✅ パフォーマンス最適化（画面外カリング、エフェクト数制限）

**Phase 5: インタラクション強化実装完了**
- ✅ デュアルモード操作システム
  - 1回クリック → 移動モード（緑色枠）
  - ダブルクリック → 回転モード（赤色枠）
- ✅ モード別右クリック操作（移動/回転）
- ✅ 滑らかな回転アニメーション
  - 目標角度まで徐々に回転（戦術的方向制御）
  - 最短回転方向の自動選択
  - 回転中の制御優先システム
  - 回転方向確定時の選択自動解除
  - 回転モード時の赤色前方楕円形表示（横90px×縦180px）
  - 移動モード時の半透明ゴースト艦隊表示
- ✅ リアルタイムモード表示（UI上部に [移動]/[回転]/[待機]）
- ✅ 視覚的フィードバック強化（色分けされた選択枠）

**次のPhase: 高度なゲームシステム実装予定**
- 提督システムと特殊能力
- 陣形システムと戦術的移動パターン
- シナリオモードとキャンペーン

## 技術スタック
- **エンジン**: PixiJS v8.12.0
- **開発環境**: Vite
- **言語**: JavaScript (ES6)

## 開発方針
1. **シンプルファースト**: 最小限の機能から始める
2. **段階的実装**: 動くものを作ってから機能追加
3. **コミット頻度**: 小さな機能ごとにGitコミット

## ファイル構造
```
fl/
├── src/
│   ├── index.html      # メインHTML
│   ├── main.js         # エントリーポイント
│   ├── Game.js         # ゲーム管理クラス
│   ├── Fleet.js        # 艦隊クラス（三角形表示、戦闘、移動）
│   ├── UI.js           # 包括的UIシステム
│   ├── Effects.js      # ビジュアルエフェクト管理
│   ├── Audio.js        # プロシージャル音響システム
│   └── style.css       # スタイル
├── public/
│   └── assets/         # ゲームアセット
├── vite.config.js      # Vite設定
├── package.json        # プロジェクト設定
├── CLAUDE.md           # 開発ログ
└── README.md           # プロジェクト説明
```

## ブラウザでの確認方法
1. `npm run dev` でサーバー起動
2. http://localhost:3000 にアクセス
3. 画面に青と赤の三角形（各3隻ずつの艦隊）が表示されることを確認
4. 左クリックで同盟軍艦隊（青）を選択し、円形枠とリングエフェクトを確認
5. ドラッグで複数の同盟軍艦隊を範囲選択できることを確認
6. 右クリックで選択した艦隊が移動し、向きが変わることを確認
7. 包括的UI（上部統計、下部詳細、右下ミニマップ、右上制御）を確認
8. 艦隊が接近すると自動戦闘が開始され、ビーム攻撃と爆発エフェクトを確認
9. 音声ボタンで音響（BGM、効果音）のON/OFF切り替えを確認
10. 敵陣営全滅時にゲーム終了画面が表示されることを確認